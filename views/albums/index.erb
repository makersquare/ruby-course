<a href="/">&lt;- Back to Everything</a>
<h1>All Albums</h1>

<ul>
  <% @albums.each do |album| %>
    <li><a href="/albums/<%=album['id']%>"><%= album['title'] %></a> - <%= @db.exec("SELECT * FROM songs where album_id = #{album['id']}").to_a.count %> songs</li>
  <% end %>
</ul>

<form action="/albums" method="post">
  <h3>New Album</h3>
  <label>Album Title:</label>
  <input name="title" type="text" />
	<div class="container" style="display:inline">
		<select name="genre_ids[]" class='drop-down'>
	  		<option> -- Please select a genre </option>
			<% @genres.each do |genre| %>
	  		<option value="<%= genre['id'] %>"><%= genre['name'] %></option>
			<% end %>
	  	</select>
	  	<a href="#" class="add-genre">add genre</a>
	</div>
  <button>Create Album</button>
</form>

<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript">
$(".add-genre").on("click", function(e) {
	e.preventDefault()
	var orig = $('select',$('drop-down').last());
	var copy = $('.drop-down').last().clone();
	$('select',copy).val(orig.val());
	copy.appendTo('.container');
	$('<a>').attr('href', '#').attr('class', 'remove-genre').text('remove genre').appendTo('.container');
})
$(document).on("click", ".remove-genre", function(e){
	e.preventDefault()
	console.log('clicked')
	$('.drop-down').last().remove();
	$('.remove-genre').last().remove();
})
</script>
